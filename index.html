<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Canadian University AI Teaching Guidelines Directory</title>
  <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    html { scroll-behavior: smooth; }
    .tag-pill { border: 1px solid rgba(0,0,0,0.08); }
  </style>
</head>

<body class="bg-gray-100 font-sans antialiased">

  <!-- Header -->
  <header class="bg-red-800 text-white shadow-md">
    <div class="container mx-auto px-6 py-6">
      <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
        <div>
          <h1 class="text-3xl font-bold">Canadian University AI Guidelines</h1>
          <p class="text-lg text-red-200">A directory for educators and teaching centers.</p>
        </div>

        <a href="https://charliegedeon.com/contact/" target="_blank" rel="noopener noreferrer"
           class="inline-block bg-white text-red-700 px-5 py-2.5 rounded-lg font-semibold hover:bg-red-50 transition-colors duration-200">
          Contact
        </a>
      </div>
    </div>
  </header>

  <div class="flex pt-0">

    <!-- Left Nav (auto-generated) -->
    <nav class="w-64 bg-gray-800 text-white p-6 hidden md:block sticky top-0 h-screen overflow-y-auto flex flex-col">
      <ul class="space-y-4 flex-1" id="province-nav">
        <li class="font-bold text-gray-400 uppercase text-sm">Provinces</li>
      </ul>
    </nav>

    <!-- Main -->
    <main class="flex-1 p-6">
      <div class="container mx-auto">
        <div class="max-w-6xl mx-auto">

          <div class="bg-white rounded-lg shadow p-5 mb-6">
            <h2 class="text-lg font-semibold text-gray-800 mb-1">About this directory</h2>
            <p class="text-sm text-gray-700 leading-relaxed mb-6">
              This simple directory is meant to help Canadian university teaching and learning units (e.g., Centres for Teaching &amp; Learning / Teaching Commons / Educational Development)
              and Canadian instructors find, compare, and share guidance on generative AI in higher education.
              If Iâ€™m missing a resource, or if a tag is misattributed, please
              <a href="https://charliegedeon.com/contact/" target="_blank" rel="noopener noreferrer"
                 class="text-red-700 hover:text-red-900 underline">contact me</a>.
            </p>

            <h2 class="text-md font-semibold text-gray-800 mb-1">Who is this?</h2>
            <p class="text-sm text-gray-700 leading-relaxed mb-1">
              ðŸ‘‹ Hello, I'm Charlie Gedeon, a university instructor, instructional and UX designer. In 2025, I gave a
              <a href="https://www.youtube.com/watch?v=m8WomdCLBqE" target="_blank" rel="noopener noreferrer"
                 class="text-red-700 hover:text-red-900 underline">TEDx Talk</a>
              on AI in education that has gained over 200,000 views.
            </p>
            <p class="text-sm text-gray-700 leading-relaxed">
              Enjoyed this resource? Add me on
              <a href="https://www.linkedin.com/in/charlesgedeon/" target="_blank" rel="noopener noreferrer"
                 class="text-red-700 hover:text-red-900 underline">LinkedIn</a>
              and subscribe to my
              <a href="https://www.youtube.com/channel/UCTAbJsNNMtsOgGZYAKtF8cA" target="_blank" rel="noopener noreferrer"
                 class="text-red-700 hover:text-red-900 underline">YouTube channel</a>.
            </p>
          </div>

          <!-- Tag Filters -->
          <div class="bg-white rounded-lg shadow p-4 mb-8">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
              <div>
                <h2 class="text-xl font-semibold text-gray-800">Audience Filters</h2>
                <p class="text-sm text-gray-600">Toggle tags to filter cards based on the intended audience of the resource.</p>
              </div>
              <div class="flex flex-wrap gap-2" id="tag-filters"></div>
            </div>
          </div>

          <!-- Sections injected here -->
          <div id="sections-root"></div>

          <footer class="text-center text-gray-500 text-sm mt-10 mb-6">
            Created by
            <a href="https://charliegedeon.com" target="_blank" rel="noopener noreferrer"
               class="text-red-700 hover:text-red-900 underline">Charlie Gedeon</a>.
            Last updated: <span id="last-updated"></span>
          </footer>

        </div>
      </div>
    </main>
  </div>

<script>
/**
 * TAG SYSTEM
 * - Instructor âœ…
 * - Student ðŸ‘¨â€ðŸŽ“
 * - Research ðŸ”¬
 * - Generic ðŸŒ
 */
const TAGS = {
  instructor: { label: "Instructor âœ…", key: "instructor" },
  student:    { label: "Student ðŸ‘¨â€ðŸŽ“", key: "student" },
  research:   { label: "Research ðŸ”¬", key: "research" },
  generic:    { label: "Generic ðŸŒ", key: "generic" },
};

/**
 * DATASET
 */
const universities = [
  // Alberta
  { name: "Athabasca University", province: "Alberta", url: null },
  { name: "MacEwan University", province: "Alberta", url: "https://www.macewan.ca/about-macewan/teaching/resources/generative-ai/" },
  { name: "Mount Royal University", province: "Alberta", url: "https://www.mtroyal.ca/AboutMountRoyal/TeachingLearning/AcademicDevelopmentCentre/ClassroomAndCurriculum/artificial-intelligence.htm" },
  { name: "University of Alberta", province: "Alberta", url: "https://www.ualberta.ca/en/centre-for-teaching-and-learning/resources/generative-ai/index.html" },
  { name: "University of Calgary", province: "Alberta", url: "https://teaching-learning.ucalgary.ca/resources-educators/generative-ai-teaching-and-learning" },
  { name: "University of Lethbridge", province: "Alberta", url: "https://www.ulethbridge.ca/teachingcentre/ai-resources" },

  // British Columbia
  { name: "Capilano University", province: "British Columbia", url: "https://cte.capilanou.ca/generative-ai/" },
  { name: "Emily Carr University of Art + Design", province: "British Columbia", url: "https://www.ecuad.ca/about/leadership-and-governance/policies/ai-guidelines" },
  { name: "Kwantlen Polytechnic University", province: "British Columbia", url: "https://www.kpu.ca/generative-ai" },
  { name: "Royal Roads University", province: "British Columbia", url: "https://www.royalroads.ca/about/academics/centre-teaching-educational-technologies/teaching-resources/generative-artificial" },
  { name: "Simon Fraser University", province: "British Columbia", url: "https://www.sfu.ca/about/leadership-governance-strategy/pan-university-initiatives/ai-at-sfu/our-approach-to-ai.html" },
  { name: "Thompson Rivers University", province: "British Columbia", url: "https://aieducation.trubox.ca/" },
  { name: "University of British Columbia", province: "British Columbia", url: "https://genai.ubc.ca/guidance/principles/" },
  { name: "University of Northern British Columbia", province: "British Columbia", url: "https://www.unbc.ca/provost/guidance-acceptability-using-generative-ai-coursework" },
  { name: "University of the Fraser Valley", province: "British Columbia", url: "https://www.ufv.ca/teaching-and-learning/artificial-intelligence/" },
  { name: "University of Victoria", province: "British Columbia", url: "https://libguides.uvic.ca/AI_Tools" },
  { name: "Vancouver Island University", province: "British Columbia", url: "https://wordpress.viu.ca/ciel/2023/09/01/what-does-ai-mean-in-your-classroom/" },

  // Manitoba
  { name: "Brandon University", province: "Manitoba", url: null },
  { name: "University of Manitoba", province: "Manitoba", url: "https://umanitoba.ca/centre-advancement-teaching-learning/integrity/artificial-intelligence" },
  { name: "University of Winnipeg", province: "Manitoba", url: "https://library.uwinnipeg.ca/borrowing-and-services/help-with-research/chatgpt-and-genai.html" },
  { name: "UniversitÃ© de Saint-Boniface", province: "Manitoba", url: null },

  // New Brunswick
  { name: "Mount Allison University", province: "New Brunswick", url: "https://libraryguides.mta.ca/genai" },
  { name: "St. Thomas University", province: "New Brunswick", url: "https://libguides.thomasu.edu/AILiteracy/Home" },
  { name: "UniversitÃ© de Moncton", province: "New Brunswick", url: "https://www.umoncton.ca/integrite/intelligence_artificielle" },
  { name: "University of New Brunswick", province: "New Brunswick", url: "https://lib.unb.ca/guides/artificial-intelligence-ai-undergraduate-students" },

  // Newfoundland and Labrador
  { name: "Memorial University of Newfoundland", province: "Newfoundland and Labrador", url: "https://www.mun.ca/citl/explore/generative-ai/" },

  // Nova Scotia
  { name: "Acadia University", province: "Nova Scotia", url: null },
  { name: "Cape Breton University", province: "Nova Scotia", url: null },
  { name: "Dalhousie University", province: "Nova Scotia", url: "https://dal.ca.libguides.com/genai/teaching" },
  { name: "Mount Saint Vincent University", province: "Nova Scotia", url: "https://libguides.msvu.ca/ai/teaching" },
  { name: "NSCAD University", province: "Nova Scotia", url: "https://library.nscad.ca/AI" },
  { name: "Saint Maryâ€™s University", province: "Nova Scotia", url: "https://studio.smu.ca/ai-in-teaching-and-learning" },
  { name: "St. Francis Xavier University", province: "Nova Scotia", url: "https://www.stfx.ca/student-services/academic-services/academic-success-centre/academic-integrity/faculty-syllabus" },
  { name: "UniversitÃ© Sainte-Anne", province: "Nova Scotia", url: null },
  { name: "University of King's College", province: "Nova Scotia", url: null },

  // Ontario
  { name: "Algoma University", province: "Ontario", url: "https://algomau.ca/academics/academic-integrity-office/faculty-resources-on-academic-integrity/guidelines-for-the-responsible-use-of-generative-ai-in-teaching-and-learning/" },
  { name: "Brock University", province: "Ontario", url: "https://brocku.ca/pedagogical-innovation/resources/guidance-on-chatgpt-and-generative-ai/" },
  { name: "Carleton University", province: "Ontario", url: "https://carleton.ca/ai/instructors/recommendations-and-guidelines/" },
  { name: "Lakehead University", province: "Ontario", url: "https://www.lakeheadu.ca/teaching-commons/teaching-and-ai" },
  { name: "Laurentian University", province: "Ontario", url: null },
  { name: "McMaster University", province: "Ontario", url: "https://mi.mcmaster.ca/generative-artificial-intelligence-in-teaching-and-learning/" },
  { name: "Nipissing University", province: "Ontario", url: "https://www.nipissingu.ca/sites/default/files/2023-07/Generative%20AI%20Guide%20for%20Instructors%20-%20July%207%2C%202023.pdf" },
  { name: "OCAD University", province: "Ontario", url: "https://www.ocadu.ca/sites/default/files/WLC/Generative%20AI%20-%20Teaching%20and%20Learning%20Strategies.pdf" },
  { name: "Ontario Tech University", province: "Ontario", url: "https://tlc.ontariotechu.ca/nexthub/artificial-intelligence/for-instructors/index.php" },
  { name: "Queen's University", province: "Ontario", url: "https://www.queensu.ca/provost/teaching-and-learning/statements-guidelines-and-resources/teaching-and-learning-statements" },
  { name: "Toronto Metropolitan University (formerly Ryerson)", province: "Ontario", url: "https://www.torontomu.ca/centre-for-excellence-in-learning-and-teaching/teaching-resources1/generative-artificial-intelligence/" },
  { name: "Trent University", province: "Ontario", url: "https://www.trentu.ca/ai-trent/ai-guidance/guidance-faculty" },
  { name: "University of Guelph", province: "Ontario", url: "https://www.uoguelph.ca/vpacademic/avpa/generative-ai-teaching-and-learning/" },
  { name: "University of Ottawa", province: "Ontario", url: "https://www.uottawa.ca/faculty-medicine/graduate-postdoctoral/research-writing-guidelines/policy-ai-llm-usage" },
  { name: "University of Toronto", province: "Ontario", url: "https://teaching.utoronto.ca/teaching-uoft-genai/" },
  { name: "University of Waterloo", province: "Ontario", url: "https://uwaterloo.ca/generative-ai/ai-use-principles-and-guidelines" },
  { name: "University of Windsor", province: "Ontario", url: "https://www.uwindsor.ca/ai/303/generative-ai-faculty" },
  { name: "Western University", province: "Ontario", url: "https://ai.uwo.ca/Guidance/index.html" },
  { name: "Wilfrid Laurier University", province: "Ontario", url: "https://researchcentres.wlu.ca/teaching-and-learning/building/generative-ai-in-teaching-and-learning.html" },
  { name: "York University", province: "Ontario", url: "https://www.yorku.ca/teachingandlearning/gen-ai/" },

  // Prince Edward Island
  { name: "University of Prince Edward Island", province: "Prince Edward Island", url: "https://sites.google.com/view/instructional-resources/guidance-on-using-generative-ai-in-teaching-and-learning" },

  // Quebec
  { name: "Bishop's University", province: "Quebec", url: "https://ubishops.libguides.com/AI-Research" },
  { name: "Concordia University", province: "Quebec", url: "https://www.concordia.ca/ctl/tech-tools/teach-with-technology/guidelines-gen-ai.html" },
  { name: "McGill University", province: "Quebec", url: "https://teachingkb.mcgill.ca/tlk/using-generative-ai-in-teaching-and-learning" },
  { name: "UniversitÃ© de MontrÃ©al", province: "Quebec", url: "https://esp.umontreal.ca/fileadmin/esp/documents/PDF/Lignes_directrices_Utilisation_IA_Memoire_et_these_Octobre2024.pdf" },
  { name: "UniversitÃ© de Sherbrooke", province: "Quebec", url: "https://www.usherbrooke.ca/ssf/enseignement/intelligence-artificielle-ia" },
  { name: "UniversitÃ© du QuÃ©bec Ã  MontrÃ©al (UQAM)", province: "Quebec", url: "https://cpu.umontreal.ca/fileadmin/cpu/documents/enseignement-apprentissage/enseigner-numerique/ia/utiliser-iag/GUI_PIM_Usages-IAg.pdf" },
  { name: "UniversitÃ© du QuÃ©bec Ã  Trois-RiviÃ¨res (UQTR)", province: "Quebec", url: "https://oraprdnt.uqtr.uquebec.ca/portail/gscw031?owa_no_site=7759" },
  { name: "UniversitÃ© du QuÃ©bec Ã  Chicoutimi (UQAC)", province: "Quebec", url: "https://www.uqac.ca/ia/boite-a-outils/" },
  { name: "UniversitÃ© du QuÃ©bec Ã  Rimouski (UQAR)", province: "Quebec", url: null },
  { name: "UniversitÃ© du QuÃ©bec en Outaouais (UQO)", province: "Quebec", url: null },
  { name: "UniversitÃ© du QuÃ©bec en Abitibi-TÃ©miscamingue (UQAT)", province: "Quebec", url: "https://www.uqat.ca/uqat/ia/" },
  { name: "Ã‰cole de technologie supÃ©rieure (Ã‰TS)", province: "Quebec", url: "https://etsmtl.libguides.com/IAgenerative" },
  { name: "Institut national de la recherche scientifique (INRS)", province: "Quebec", url: null },
  { name: "TÃ©lÃ©-universitÃ© (TELUQ)", province: "Quebec", url: null },
  { name: "Ã‰cole nationale d'administration publique (ENAP)", province: "Quebec", url: null },
  { name: "UniversitÃ© Laval", province: "Quebec", url: "https://www.ulaval.ca/en/information-technology/artificial-intelligence-systems" },

  // Saskatchewan
  { name: "University of Regina", province: "Saskatchewan", url: "https://ctl.uregina.ca/generative-ai-at-the-university-of-regina" },
  { name: "University of Saskatchewan", province: "Saskatchewan", url: "https://ai.usask.ca/index.php" },
];

/**
 * Tagging heuristics
 */
function inferTags(url) {
  if (!url) return [];
  const u = url.toLowerCase();
  const tags = new Set();

  if (u.includes("libguides") || u.includes("/library") || u.includes("research") || u.includes("graduate-postdoctoral")) {
    tags.add("research");
  }

  if (
    u.includes("teaching") ||
    u.includes("teaching-learning") ||
    u.includes("teachingcentre") ||
    u.includes("centre-for-teaching") ||
    u.includes("ctl") ||
    u.includes("tlc") ||
    u.includes("for-instructors") ||
    u.includes("instructors") ||
    u.includes("faculty") ||
    u.includes("teaching-commons")
  ) {
    tags.add("instructor");
  }

  if (u.includes("integrity") || u.includes("undergraduate") || u.includes("academic-success")) {
    tags.add("student");
  }

  if (u.includes("principles") || u.includes("policy") || u.includes("strategy") || u.includes("governance") || u.includes("guidance")) {
    tags.add("generic");
  }

  if (u.endsWith(".pdf")) {
    tags.add("generic");
    if (u.includes("instructor") || u.includes("teaching")) tags.add("instructor");
  }

  if (tags.size === 0) tags.add("generic");
  return Array.from(tags);
}

/**
 * Manual tag overrides
 */
const tagOverrides = {
  "Capilano University": ["instructor"],
  "University of British Columbia": ["generic"],
  "Simon Fraser University": ["generic"],
  "Emily Carr University of Art + Design": ["generic"],
  "University of Ottawa": ["research", "generic"],
  "University of Victoria": ["research", "student"],
  "University of Winnipeg": ["research", "student"],
  "University of New Brunswick": ["research", "student"],
  "Mount Allison University": ["research", "student"],
  "Ã‰cole de technologie supÃ©rieure (Ã‰TS)": ["research", "student"],
  "UniversitÃ© Laval": ["generic"],
  "University of Waterloo": ["generic", "instructor"],
  "Thompson Rivers University": ["instructor", "student"],
  "Mount Saint Vincent University": ["research", "instructor"],
  "Dalhousie University": ["research", "instructor"],
  "Bishop's University": ["research", "student"],
  "UniversitÃ© de MontrÃ©al": ["research", "generic"],
  "UniversitÃ© du QuÃ©bec Ã  MontrÃ©al (UQAM)": ["generic"],
};

/**
 * Written-by heuristics + manual overrides
 */
function inferWrittenBy(url) {
  if (!url) return null;
  const u = url.toLowerCase();

  if (u.includes("libguides") || u.includes("/library") || u.includes("library.")) {
    return "Library";
  }

  if (
    u.includes("centre-for-teaching") ||
    u.includes("teaching-learning") ||
    u.includes("teachingcentre") ||
    u.includes("teaching-centre") ||
    u.includes("teaching-commons") ||
    u.includes("/ctl") ||
    u.includes("ctl.") ||
    u.includes("/citl") ||
    u.includes("citl.") ||
    u.includes("/tlc") ||
    u.includes("tlc.") ||
    u.includes("centre-for-excellence-in-learning-and-teaching") ||
    u.includes("pedagogical-innovation")
  ) {
    return "Teaching & Learning Unit";
  }

  if (u.includes("provost") || u.includes("vpacademic") || u.includes("vp-academic")) {
    return "Office of the Provost / Academic Leadership";
  }

  if (u.includes("integrity") || u.includes("academic-success") || u.includes("academic-integrity")) {
    return "Academic Integrity / Student Success";
  }

  if (u.includes("faculty-") || u.includes("/faculty/") || u.includes("faculty-medicine")) {
    return "Faculty / School";
  }

  if (u.includes("information-technology") || (u.includes("it") && u.includes("artificial-intelligence"))) {
    return "Information Technology";
  }

  return "University-wide / General";
}

const writtenByOverrides = {
  // Alberta
  "MacEwan University": "Centre for Teaching & Learning",
  "Mount Royal University": "Academic Development Centre",
  "University of Alberta": "Centre for Teaching & Learning",
  "University of Calgary": "Teaching & Learning Unit",
  "University of Lethbridge": "Teaching Centre",

  // British Columbia
  "Capilano University": "Centre for Teaching Excellence",
  "Royal Roads University": "Centre for Teaching & Educational Technologies",
  "University of Northern British Columbia": "Office of the Provost",
  "University of Victoria": "Library",
  "Simon Fraser University": "University-wide / Strategy",
  "University of British Columbia": "University-wide / Principles",

  // Manitoba
  "University of Manitoba": "Academic Integrity / Teaching & Learning Unit",
  "University of Winnipeg": "Library",

  // New Brunswick
  "Mount Allison University": "Library",
  "St. Thomas University": "Library",
  "UniversitÃ© de Moncton": "Academic Integrity",
  "University of New Brunswick": "Library",

  // Newfoundland and Labrador
  "Memorial University of Newfoundland": "Centre for Innovation in Teaching & Learning (CITL)",

  // Nova Scotia
  "Dalhousie University": "Centre for Learning & Teaching",
  "Mount Saint Vincent University": "Library",
  "NSCAD University": "Library",

  // Ontario
  "Brock University": "Centre for Pedagogical Innovation",
  "Carleton University": "University-wide / Teaching Support",
  "McMaster University": "MacPherson Institute",
  "Ontario Tech University": "Teaching & Learning Centre",
  "Toronto Metropolitan University (formerly Ryerson)": "Centre for Excellence in Learning & Teaching",
  "University of Toronto": "Centre for Teaching Support & Innovation (CTSI)",
  "University of Ottawa": "Faculty of Medicine (Graduate Studies)",
  "Queen's University": "Office of the Provost",
  "University of Guelph": "Office of the Vice-Provost (Academic)",
  "Wilfrid Laurier University": "Teaching & Learning Unit",
  "York University": "Teaching & Learning Unit",

  // Quebec
  "Concordia University": "Centre for Teaching & Learning",
  "McGill University": "Teaching & Learning Knowledge Base",
  "UniversitÃ© de MontrÃ©al": "Graduate Studies (Policy / Guidelines)",
  "Ã‰cole de technologie supÃ©rieure (Ã‰TS)": "Library",
  "UniversitÃ© Laval": "Information Technology",

  // Saskatchewan
  "University of Regina": "Centre for Teaching & Learning",
  "University of Saskatchewan": "University-wide / Role-based Guidance",
};

/**
 * Build records
 */
const data = universities.map(u => {
  const inferredTags = inferTags(u.url);
  const overriddenTags = tagOverrides[u.name] || null;

  const inferredWrittenBy = inferWrittenBy(u.url);
  const overriddenWrittenBy = writtenByOverrides[u.name] || null;

  return {
    ...u,
    tags: overriddenTags ? overriddenTags : inferredTags,
    writtenBy: overriddenWrittenBy ? overriddenWrittenBy : inferredWrittenBy,
  };
});

/**
 * UI STATE
 */
let activeTagKeys = new Set(); // AND logic: must contain ALL selected tags; empty => show all

function slugifyProvince(prov) {
  return prov.toLowerCase().replace(/\s+/g, "-").replace(/[â€™']/g, "");
}

function tagPill(tagKey) {
  const label = TAGS[tagKey]?.label || tagKey;
  return `
    <span class="tag-pill inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-gray-50 text-gray-700">
      ${label}
    </span>
  `;
}

function pdfBadge(url) {
  if (!url) return "";
  const isPdf = url.toLowerCase().endsWith(".pdf");
  if (!isPdf) return "";
  return `
    <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-yellow-50 text-yellow-800 border border-yellow-200">
      PDF
    </span>
  `;
}

function cardTemplate(u) {
  const hasLink = !!u.url;
  const tagsHtml = (u.tags || []).map(tagPill).join("");
  const badge = pdfBadge(u.url);

  const writtenBy = u.writtenBy
    ? `<p class="text-sm text-gray-600 mb-3"><span class="font-semibold">Written by:</span> ${u.writtenBy}</p>`
    : "";

  const button = hasLink
    ? `<a href="${u.url}" target="_blank" rel="noopener noreferrer"
         class="inline-block bg-red-700 text-white px-5 py-2.5 rounded-lg hover:bg-red-900 transition-colors duration-200">
         Visit Resource
       </a>`
    : `<button disabled
         class="inline-block bg-gray-500 text-white px-5 py-2.5 rounded-lg opacity-60 cursor-not-allowed">
         No Link
       </button>`;

  return `
    <div class="bg-white rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow duration-300 flex flex-col h-full">
      <div class="flex items-start justify-between gap-3 mb-2">
        <h3 class="text-xl font-semibold text-gray-800">${u.name}</h3>
        ${badge}
      </div>

      ${writtenBy}
      <div class="flex flex-wrap gap-2 align-middle mb-4"><span class="text-sm text-gray-600 font-semibold">Audience:</span>${tagsHtml}</div>
      
      <div class="mt-auto">
        ${button}
      </div>
    </div>
  `;
}

/**
 * AND logic filter:
 * - If user selected tags: the card must include ALL selected tags
 */
function matchesActiveTags_AND(u) {
  if (activeTagKeys.size === 0) return true;
  const ut = new Set(u.tags || []);
  for (const t of activeTagKeys) {
    if (!ut.has(t)) return false;
  }
  return true;
}

/**
 * Render functions
 */
function renderNav(provinces) {
  const nav = document.getElementById("province-nav");
  provinces.forEach(p => {
    const id = slugifyProvince(p);
    const li = document.createElement("li");
    li.innerHTML = `<a href="#${id}" class="block py-2 px-4 rounded hover:bg-gray-700">${p}</a>`;
    nav.appendChild(li);
  });
}

function renderTagFilters() {
  const root = document.getElementById("tag-filters");
  root.innerHTML = "";

  Object.values(TAGS).forEach(t => {
    const btn = document.createElement("button");
    btn.className = "px-3 py-2 rounded-lg border text-sm font-medium bg-white hover:bg-gray-50 transition";
    btn.dataset.tag = t.key;
    btn.innerText = t.label;

    btn.addEventListener("click", () => {
      const key = t.key;
      if (activeTagKeys.has(key)) activeTagKeys.delete(key);
      else activeTagKeys.add(key);
      updateFilterButtonStyles();
      renderSections();
    });

    root.appendChild(btn);
  });

  const clear = document.createElement("button");
  clear.className = "px-3 py-2 rounded-lg border text-sm font-medium bg-gray-800 text-white hover:bg-gray-700 transition";
  clear.innerText = "Clear";
  clear.addEventListener("click", () => {
    activeTagKeys.clear();
    updateFilterButtonStyles();
    renderSections();
  });
  root.appendChild(clear);

  updateFilterButtonStyles();
}

function updateFilterButtonStyles() {
  document.querySelectorAll("#tag-filters button[data-tag]").forEach(btn => {
    const key = btn.dataset.tag;
    if (activeTagKeys.has(key)) {
      btn.className = "px-3 py-2 rounded-lg border text-sm font-medium bg-red-600 text-white hover:bg-red-800 transition";
    } else {
      btn.className = "px-3 py-2 rounded-lg border text-sm font-medium bg-white hover:bg-gray-50 transition";
    }
  });
}

function renderSections() {
  const root = document.getElementById("sections-root");
  root.innerHTML = "";

  const grouped = {};
  data.forEach(u => {
    if (!grouped[u.province]) grouped[u.province] = [];
    grouped[u.province].push(u);
  });

  const provinces = Object.keys(grouped).sort((a,b) => a.localeCompare(b));

  provinces.forEach(prov => {
    const id = slugifyProvince(prov);
    const items = grouped[prov]
      .slice()
      .sort((a,b) => a.name.localeCompare(b.name))
      .filter(matchesActiveTags_AND);

    const section = document.createElement("section");
    section.id = id;
    section.className = "mb-10";

    section.innerHTML = `
      <h2 class="text-4xl font-extrabold text-red-700 mb-6 border-b-2 border-red-300 pb-2">${prov}</h2>
      ${
        items.length === 0
          ? `<div class="bg-white rounded-lg shadow p-6 text-gray-700">No results for the selected tags in ${prov}.</div>`
          : `<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
               ${items.map(cardTemplate).join("")}
             </div>`
      }
    `;

    root.appendChild(section);
  });
}

/**
 * Init
 */
(function init(){
  const now = new Date();
  document.getElementById("last-updated").innerText =
    now.toLocaleDateString(undefined, { year: "numeric", month: "short", day: "numeric" });

  const provinces = Array.from(new Set(data.map(d => d.province))).sort((a,b) => a.localeCompare(b));
  renderNav(provinces);

  renderTagFilters();
  renderSections();
})();
</script>

</body>
</html>